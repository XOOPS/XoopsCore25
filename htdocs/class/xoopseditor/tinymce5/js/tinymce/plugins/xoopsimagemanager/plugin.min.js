/**
 * XOOOPS Image Manager plugin
 *
 * @category  XoopsEditor
 * @package   TinyMCE7
 * @author    ForMuss
 * @copyright 2020 XOOPS Project (http://xoops.org)
 * @license   GNU GPL 2 or later (http://www.gnu.org/licenses/gpl-2.0.html)
 * @link      http://xoops.org
 */
!function(){"use strict";var ed,url,global=tinymce.util.Tools.resolve("tinymce.PluginManager"),xoopsimagemanager=function(cb,value,meta){ed.focus(!0),window.addEventListener("message",function receiveMessage(event){window.removeEventListener("message",receiveMessage,!1),"responsivefilemanager"===event.data.sender&&callback(event.data.url)},!1),ed.windowManager.openUrl({title:"XOOPS Imagemanager",url:url+"/xoopsimagemanager.php?target=src",buttons:[{type:"cancel",text:"Close"}],width:800,height:600,inline:1,resizable:!0,maximizable:!0,onMessage:function(instance,event){if("insertImage"===event.mceAction)""!=event.data.src&&setTimeout(()=>{cb(event.data.src,{title:event.data.title}),tinymce.activeEditor.windowManager.close()},300)}})};global.add("xoopsimagemanager",function(editor,pluginUrl){ed=editor,url=pluginUrl,function(editor){editor.settings.file_picker_types="image",editor.settings.file_picker_callback=xoopsimagemanager}(editor)})}(window);