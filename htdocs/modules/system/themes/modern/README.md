# XOOPS Modern Admin Theme

A modern, responsive admin theme for XOOPS 2.5.12 with an enhanced dashboard, dark mode, customizer panel, module widget system, and configurable content tracking.

## Features

### Modern Design
- Clean, card-based interface with CSS custom properties
- Smooth animations and transitions
- Responsive layout for desktop, tablet, and mobile
- Consistent styling via design tokens (`--primary`, `--radius`, `--shadow`, etc.)

### Enhanced Dashboard
- **KPI Cards** — Total users, active modules, active users, server load with trend indicators
- **Interactive Charts** (Chart.js) — User registration trends, group distribution, configurable content tracking across modules
- **Collapsible System Information** — PHP, MySQL, Smarty versions, server config, Composer packages
- **Module Widgets** — Any module can provide a dashboard widget (see [Module Integration Guide](docs/MODULE_INTEGRATION_GUIDE.md))

### Dark Mode
- Toggle via moon/sun icon in the header toolbar
- All elements adapt: cards, charts, tables, forms, messages, widgets
- Preference persisted in cookies

### Responsive Sidebar
- Collapsible sections (Modules, System) using `<details>/<summary>`
- Collapses to icon-only mode on desktop; overlay on mobile
- Toggle via hamburger icon in header

### Customizer Panel
- Theme color picker (8 presets + custom hex)
- Font size slider (12-18px)
- Content tracking module selector (choose which modules appear in the chart)
- Layout toggles: compact sidebar, compact view, disable animations
- Close button at top and bottom of panel

### Module Admin Pages
- **Admin links bar** — Preferences | Update | Blocks | Templates | Comments | Uninstall | Go to module (generated by XOOPS core `SystemMenuHandler`)
- **Tab navigation** — Styled with bottom accent bar and current-tab indicator
- **Icon toolbar** — Module admin icons inline with module name
- **System Services** — Always visible in header toolbar regardless of active module

### Message Handling
- Warning/error messages auto-move to top of content area
- Slide-down animation on appear
- Auto-dismiss after 5 seconds with slide-up animation

## Requirements

- XOOPS 2.5.12+
- PHP 7.4 or higher (tested through PHP 8.4)
- Chart.js 4.x — local or CDN (see [Installation](#2-chartjs-dependency))

## Installation

### 1. Upload Theme Files

Copy the `modern/` folder to:

```text
modules/system/themes/modern/
```

### 2. Chart.js Dependency

The theme automatically detects whether Chart.js is available locally. If found, it loads from `xoops_lib/Frameworks/chartjs/chart.min.js`; otherwise it falls back to the **jsDelivr CDN** (`cdn.jsdelivr.net/npm/chart.js@4`). Charts will work out of the box with no extra setup.

To bundle Chart.js locally (recommended for offline/intranet environments):

1. Download [Chart.js 4.x](https://www.chartjs.org/) (`chart.umd.min.js` or `chart.min.js`)
2. Create: `xoops_lib/Frameworks/chartjs/`
3. Place `chart.min.js` inside that directory
4. Add an `index.php` with `header("HTTP/1.0 403 Forbidden");` for security

### 3. Activate Theme

1. Log in to XOOPS admin
2. Go to **System Admin** > **Preferences** > **General Settings**
3. Set **Admin GUI** to **modern**
4. Click **Submit**

### 4. Clear Cache

Go to **System Admin** > **Maintenance** and clear Smarty template cache and XOOPS cache.

## File Structure

```text
modern/
├── modern.php                 # Main theme class (extends XoopsSystemGui)
├── theme.tpl                  # Root Smarty template
├── menu.php                   # Admin menu definition
├── README.md                  # This file
├── index.php                  # Directory listing protection
├── class/
│   ├── ModuleWidgetInterface.php  # Widget contract for modules
│   └── WidgetLoader.php           # Auto-discovers module widgets
├── css/
│   ├── modern.css             # Main stylesheet + light mode variables
│   ├── dark.css               # Dark mode variable overrides
│   └── fixes.css              # !important overrides for XOOPS core CSS
├── js/
│   ├── theme.js               # Sidebar, dark mode, messages, help toggle
│   ├── charts.js              # Chart.js initialization and content filtering
│   ├── customizer.js          # Customizer panel logic and cookie persistence
│   └── dashboard.js           # Dashboard table interactions
├── xotpl/
│   ├── xo_metas.tpl           # Meta tags and charset
│   ├── xo_scripts.tpl         # CSS/JS includes
│   ├── xo_head.tpl            # Header bar (brand, system services, dark mode toggle)
│   ├── xo_sidebar.tpl         # Sidebar navigation (collapsible sections)
│   ├── xo_toolbar.tpl         # Toolbar (deprecated, kept for compatibility)
│   ├── xo_dashboard.tpl       # Dashboard layout (KPIs, charts, system info, widgets)
│   ├── xo_widgets.tpl         # Dynamic module widget renderer
│   ├── xo_customizer.tpl      # Customizer slide-out panel
│   ├── xo_page.tpl            # Content area (module admin links + tabs + content)
│   └── xo_footer.tpl          # Footer bar
├── icons/                     # System service icons (PNG, small + large)
├── images/                    # Theme images
├── language/english/
│   └── main.php               # Language constants
├── widgets/                   # Pre-built widgets for common modules
│   ├── alumni/class/ModernThemeWidget.php
│   ├── jobs/class/ModernThemeWidget.php
│   ├── newbb/class/ModernThemeWidget.php
│   ├── news/class/ModernThemeWidget.php
│   ├── pedigree/class/ModernThemeWidget.php
│   ├── protector/class/ModernThemeWidget.php
│   ├── publisher/class/ModernThemeWidget.php
│   ├── realestate/class/ModernThemeWidget.php
│   ├── tdmdownloads/class/ModernThemeWidget.php
│   ├── vision2026/class/ModernThemeWidget.php
│   └── xblog/class/ModernThemeWidget.php
├── docs/
│   └── MODULE_INTEGRATION_GUIDE.md  # How to add widgets from your module
└── tests/
    ├── ThemeCompatibilityTest.php   # PHP compatibility test
    └── test-theme.sh                # Shell-based smoke test
```

## Customization

### Theme Colors

Edit `css/modern.css` `:root` block, or use the built-in Customizer panel (gear icon in sidebar footer):

```css
:root {
    --primary: #2563eb;
    --primary-dark: #1d4ed8;
    --primary-light: #3b82f6;
    --success: #10b981;
    --warning: #f59e0b;
    --danger: #ef4444;
}
```

### Dark Mode Colors

Edit `css/dark.css` to adjust the dark palette. Variables are scoped to `body.dark-mode`.

### Content Tracking

Users can select which modules appear in the Content Distribution chart via the Customizer panel. The selection is saved in a cookie and persists across sessions.

### Module Widgets

Any installed module can provide a dashboard widget. The theme includes **pre-built widgets** for 11 common modules in the `widgets/` folder — just copy the relevant `class/` folder into your module directory:

```text
Copy:  themes/modern/widgets/publisher/class/ModernThemeWidget.php
  To:  modules/publisher/class/ModernThemeWidget.php
```

Available widgets: Alumni, Jobs, NewBB, News, Pedigree, Protector, Publisher, RealEstate, TDMDownloads, Vision2026, XBlog.

To create a custom widget for your own module, see [docs/MODULE_INTEGRATION_GUIDE.md](docs/MODULE_INTEGRATION_GUIDE.md).

## CSS Architecture

| File | Purpose | Uses `!important`? |
|------|---------|-------------------|
| `modern.css` | Design tokens, layout, components, dark mode overrides | No |
| `dark.css` | Dark mode CSS variable reassignment | No |
| `fixes.css` | Overrides for XOOPS core inline styles and `menu.css` | Yes (required) |

Key design tokens: `--primary`, `--bg-primary`, `--bg-secondary`, `--text-primary`, `--border`, `--radius`, `--shadow`, `--sidebar-width`, `--header-height`.

## Browser Support

- Chrome / Edge (latest 2 versions)
- Firefox (latest 2 versions)
- Safari (latest 2 versions)
- Mobile Chrome / Safari

## Dependencies

| Dependency | Source | Notes |
|-----------|--------|-------|
| jQuery | XOOPS core | Already included |
| Chart.js 4.x | `xoops_lib/Frameworks/chartjs/` or jsDelivr CDN | Auto-detected; CDN fallback if local file missing |
| ComposerInfo.php | `modules/system/themes/ComposerInfo.php` | Shared across admin themes |

## Troubleshooting

### Theme doesn't appear in Admin GUI dropdown

- Verify folder is named exactly `modern` inside `modules/system/themes/`
- Check that `modern.php` exists and contains `class ModernTheme extends XoopsSystemGui`

### Charts not displaying

- Charts load automatically via local file or CDN fallback — no setup required
- If behind a firewall with no internet access, ensure `xoops_lib/Frameworks/chartjs/chart.min.js` exists locally
- Check browser console for JS errors
- Ensure `browse.php` is accessible at the webroot (for local loading)

### Module admin links missing (Preferences | Update | ...)

- The links come from `$xo_system_menu` generated by the XOOPS core `gui.php`
- They only appear for non-system modules that set `'system_menu' => 1` in `xoops_version.php`

### Widgets not showing on dashboard

- Module must be installed and active
- Widget file must be at `modules/{dirname}/class/ModernThemeWidget.php` (copy from `widgets/` if available)
- Class name must be `{Ucfirst_dirname}ModernThemeWidget`
- `getWidgetData()` must return a non-empty array
- Clear Smarty cache after adding a new widget

### Dark mode not persisting

- Cookies must be enabled in the browser
- The cookie name is `xoops_dark_mode`

## Credits

**Author**: Mamba (mambax7@gmail.com)
**Version**: 1.0
**License**: GNU GPL 2.0 or later
**XOOPS**: 2.5.12+
**PHP**: 7.4 - 8.4

## Changelog

### Version 1.0 (2026-02)

- Card-based dashboard with KPI metrics
- Interactive charts (user trends, group distribution, content tracking)
- Dark mode with full component coverage
- Responsive sidebar with collapsible sections
- Customizer panel (colors, font size, content modules, layout toggles)
- Module widget system (auto-discovery via `ModernThemeWidgetInterface`) with 11 pre-built widgets
- Module admin links bar (Preferences | Update | Blocks | Templates | ...)
- Styled tab navigation with current-tab indicator
- System Services always visible in header toolbar
- Warning/error message auto-dismiss
- Collapsible System Information and Composer Packages sections
- Chart.js bundled via XOOPS Frameworks pattern
- PHP 8.1+ compatible (no `strftime()` deprecation warnings)

## Support

- XOOPS Community: https://xoops.org/
- Issues: mambax7@gmail.com

---

**Enjoy your modern XOOPS admin experience!**
